<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hf.mapper.MomentMapper">



<select id="selectMomentsWithContent" resultType="com.hf.domain.MomentWithContent">
    <![CDATA[
    SELECT RN, MOMENTID, WRITER, CATEGORY, LOCATION, TEXT, POSTTIME,
           CONTENTID, REFERENCEID,
           CONTENTPATH1, CONTENTPATH2, CONTENTPATH3, CONTENTPATH4, CONTENTPATH5,
           CONTENTPATH6, CONTENTPATH7, CONTENTPATH8, CONTENTPATH9, CONTENTPATH10
    FROM (
        SELECT ROWNUM AS RN, M.MOMENTID, M.WRITER, M.CATEGORY, M.LOCATION, M.TEXT, M.POSTTIME,
               C.CONTENTID, C.REFERENCEID,
               C.CONTENTPATH1, C.CONTENTPATH2, C.CONTENTPATH3, C.CONTENTPATH4, C.CONTENTPATH5,
               C.CONTENTPATH6, C.CONTENTPATH7, C.CONTENTPATH8, C.CONTENTPATH9, C.CONTENTPATH10
        FROM MOMENT M
        JOIN CONTENTSRC C ON M.MOMENTID = C.REFERENCEID
        WHERE C.CONTENTTYPE = 1) 
    WHERE RN >= ((#{pageNum} - 1) * 10 + 1) AND RN <= (#{pageNum} * 10)
    ]]>
</select>
<select id="countMomentsWithContent" resultType="int">
    SELECT COUNT(*)
    FROM MOMENT M
    JOIN CONTENTSRC C ON M.MOMENTID = C.REFERENCEID
    WHERE C.CONTENTTYPE = 1
</select>


</mapper>